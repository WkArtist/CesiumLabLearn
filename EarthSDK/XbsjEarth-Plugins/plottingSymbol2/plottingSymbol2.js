!function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,i){!function(e,t){if(!v[e]||!C[e])return;for(var i in C[e]=!1,t)Object.prototype.hasOwnProperty.call(t,i)&&(m[i]=t[i]);0==--g&&0===S&&x()}(e,i),t&&t(e,i)};var i,r=!0,o="18cd37205651cdc4e95b",s={},n=[],a=[];function l(e){var t=z[e];if(!t)return I;var r=function(r){return t.hot.active?(z[r]?-1===z[r].parents.indexOf(e)&&z[r].parents.push(e):(n=[e],i=r),-1===t.children.indexOf(r)&&t.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+e),n=[]),I(r)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return I[e]},set:function(t){I[e]=t}}};for(var s in I)Object.prototype.hasOwnProperty.call(I,s)&&"e"!==s&&"t"!==s&&Object.defineProperty(r,s,o(s));return r.e=function(e){return"ready"===p&&d("prepare"),S++,I.e(e).then(t,(function(e){throw t(),e}));function t(){S--,"prepare"===p&&(w[e]||b(e),0===S&&0===g&&x())}},r.t=function(e,t){return 1&t&&(e=r(e)),I.t(e,-2&t)},r}function c(t){var r={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:i!==t,active:!0,accept:function(e,t){if(void 0===e)r._selfAccepted=!0;else if("function"==typeof e)r._selfAccepted=e;else if("object"==typeof e)for(var i=0;i<e.length;i++)r._acceptedDependencies[e[i]]=t||function(){};else r._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)r._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)r._declinedDependencies[e[t]]=!0;else r._declinedDependencies[e]=!0},dispose:function(e){r._disposeHandlers.push(e)},addDisposeHandler:function(e){r._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=r._disposeHandlers.indexOf(e);t>=0&&r._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,p){case"idle":(m={})[t]=e[t],d("ready");break;case"ready":O(t);break;case"prepare":case"check":case"dispose":case"apply":(y=y||[]).push(t)}},check:M,apply:E,status:function(e){if(!e)return p;h.push(e)},addStatusHandler:function(e){h.push(e)},removeStatusHandler:function(e){var t=h.indexOf(e);t>=0&&h.splice(t,1)},data:s[t]};return i=void 0,r}var h=[],p="idle";function d(e){p=e;for(var t=0;t<h.length;t++)h[t].call(null,e)}var u,m,f,y,g=0,S=0,w={},C={},v={};function _(e){return+e+""===e?+e:e}function M(e){if("idle"!==p)throw new Error("check() is only allowed in idle status");return r=e,d("check"),(t=1e4,t=t||1e4,new Promise((function(e,i){if("undefined"==typeof XMLHttpRequest)return i(new Error("No browser support"));try{var r=new XMLHttpRequest,s=I.p+""+o+".hot-update.json";r.open("GET",s,!0),r.timeout=t,r.send(null)}catch(e){return i(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)i(new Error("Manifest request to "+s+" timed out."));else if(404===r.status)e();else if(200!==r.status&&304!==r.status)i(new Error("Manifest request to "+s+" failed."));else{try{var t=JSON.parse(r.responseText)}catch(e){return void i(e)}e(t)}}}))).then((function(e){if(!e)return d(P()?"ready":"idle"),null;C={},w={},v=e.c,f=e.h,d("prepare");var t=new Promise((function(e,t){u={resolve:e,reject:t}}));m={};return b(0),"prepare"===p&&0===S&&0===g&&x(),t}));var t}function b(e){v[e]?(C[e]=!0,g++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=I.p+""+e+"."+o+".hot-update.js",document.head.appendChild(t)}(e)):w[e]=!0}function x(){d("ready");var e=u;if(u=null,e)if(r)Promise.resolve().then((function(){return E(r)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var i in m)Object.prototype.hasOwnProperty.call(m,i)&&t.push(_(i));e.resolve(t)}}function E(t){if("ready"!==p)throw new Error("apply() is only allowed in ready status");return function t(r){var a,l,c,h,p;function u(e){for(var t=[e],i={},r=t.map((function(e){return{chain:[e],id:e}}));r.length>0;){var o=r.pop(),s=o.id,n=o.chain;if((h=z[s])&&(!h.hot._selfAccepted||h.hot._selfInvalidated)){if(h.hot._selfDeclined)return{type:"self-declined",chain:n,moduleId:s};if(h.hot._main)return{type:"unaccepted",chain:n,moduleId:s};for(var a=0;a<h.parents.length;a++){var l=h.parents[a],c=z[l];if(c){if(c.hot._declinedDependencies[s])return{type:"declined",chain:n.concat([l]),moduleId:s,parentId:l};-1===t.indexOf(l)&&(c.hot._acceptedDependencies[s]?(i[l]||(i[l]=[]),g(i[l],[s])):(delete i[l],t.push(l),r.push({chain:n.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:i}}function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];-1===e.indexOf(r)&&e.push(r)}}P();var S={},w=[],C={},M=function(){console.warn("[HMR] unexpected require("+x.moduleId+") to disposed module")};for(var b in m)if(Object.prototype.hasOwnProperty.call(m,b)){var x;p=_(b),x=m[b]?u(p):{type:"disposed",moduleId:b};var E=!1,O=!1,j=!1,T="";switch(x.chain&&(T="\nUpdate propagation: "+x.chain.join(" -> ")),x.type){case"self-declined":r.onDeclined&&r.onDeclined(x),r.ignoreDeclined||(E=new Error("Aborted because of self decline: "+x.moduleId+T));break;case"declined":r.onDeclined&&r.onDeclined(x),r.ignoreDeclined||(E=new Error("Aborted because of declined dependency: "+x.moduleId+" in "+x.parentId+T));break;case"unaccepted":r.onUnaccepted&&r.onUnaccepted(x),r.ignoreUnaccepted||(E=new Error("Aborted because "+p+" is not accepted"+T));break;case"accepted":r.onAccepted&&r.onAccepted(x),O=!0;break;case"disposed":r.onDisposed&&r.onDisposed(x),j=!0;break;default:throw new Error("Unexception type "+x.type)}if(E)return d("abort"),Promise.reject(E);if(O)for(p in C[p]=m[p],g(w,x.outdatedModules),x.outdatedDependencies)Object.prototype.hasOwnProperty.call(x.outdatedDependencies,p)&&(S[p]||(S[p]=[]),g(S[p],x.outdatedDependencies[p]));j&&(g(w,[x.moduleId]),C[p]=M)}var A,R=[];for(l=0;l<w.length;l++)p=w[l],z[p]&&z[p].hot._selfAccepted&&C[p]!==M&&!z[p].hot._selfInvalidated&&R.push({module:p,parents:z[p].parents.slice(),errorHandler:z[p].hot._selfAccepted});d("dispose"),Object.keys(v).forEach((function(e){!1===v[e]&&function(e){delete installedChunks[e]}(e)}));var W,D,H=w.slice();for(;H.length>0;)if(p=H.pop(),h=z[p]){var V={},X=h.hot._disposeHandlers;for(c=0;c<X.length;c++)(a=X[c])(V);for(s[p]=V,h.hot.active=!1,delete z[p],delete S[p],c=0;c<h.children.length;c++){var k=z[h.children[c]];k&&((A=k.parents.indexOf(p))>=0&&k.parents.splice(A,1))}}for(p in S)if(Object.prototype.hasOwnProperty.call(S,p)&&(h=z[p]))for(D=S[p],c=0;c<D.length;c++)W=D[c],(A=h.children.indexOf(W))>=0&&h.children.splice(A,1);d("apply"),void 0!==f&&(o=f,f=void 0);for(p in m=void 0,C)Object.prototype.hasOwnProperty.call(C,p)&&(e[p]=C[p]);var L=null;for(p in S)if(Object.prototype.hasOwnProperty.call(S,p)&&(h=z[p])){D=S[p];var N=[];for(l=0;l<D.length;l++)if(W=D[l],a=h.hot._acceptedDependencies[W]){if(-1!==N.indexOf(a))continue;N.push(a)}for(l=0;l<N.length;l++){a=N[l];try{a(D)}catch(e){r.onErrored&&r.onErrored({type:"accept-errored",moduleId:p,dependencyId:D[l],error:e}),r.ignoreErrored||L||(L=e)}}}for(l=0;l<R.length;l++){var U=R[l];p=U.module,n=U.parents,i=p;try{I(p)}catch(e){if("function"==typeof U.errorHandler)try{U.errorHandler(e)}catch(t){r.onErrored&&r.onErrored({type:"self-accept-error-handler-errored",moduleId:p,error:t,originalError:e}),r.ignoreErrored||L||(L=t),L||(L=e)}else r.onErrored&&r.onErrored({type:"self-accept-errored",moduleId:p,error:e}),r.ignoreErrored||L||(L=e)}}if(L)return d("fail"),Promise.reject(L);if(y)return t(r).then((function(e){return w.forEach((function(t){e.indexOf(t)<0&&e.push(t)})),e}));return d("idle"),new Promise((function(e){e(w)}))}(t=t||{})}function P(){if(y)return m||(m={}),y.forEach(O),y=void 0,!0}function O(t){Object.prototype.hasOwnProperty.call(m,t)||(m[t]=e[t])}var z={};function I(t){if(z[t])return z[t].exports;var i=z[t]={i:t,l:!1,exports:{},hot:c(t),parents:(a=n,n=[],a),children:[]};return e[t].call(i.exports,i,i.exports,l(t)),i.l=!0,i.exports}I.m=e,I.c=z,I.d=function(e,t,i){I.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},I.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},I.t=function(e,t){if(1&t&&(e=I(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(I.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)I.d(i,r,function(t){return e[t]}.bind(null,r));return i},I.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return I.d(t,"a",t),t},I.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},I.p="",I.h=function(){return o},l(0)(I.s=0)}([function(e,t,i){"use strict";i.r(t);class r extends XE.Obj.PlotBase{constructor(e,t){super(e,t),this._onlyMove=!1,this._fixedPositionsNum=void 0,XE.MVVM.extend(this,{_polygonShow:!0}),this._polygon=new XE.Obj.Polygon(e),this.disposers.push(()=>{this._polygon=this._polygon&&this._polygon.destroy()}),this._polygon.show=this._polygonShow&&this.show,XE.Earth.Interaction.Picking.registerPickingParent(this._polygon,this);const i=()=>{this._polygon.show=this._polygonShow&&this.show,this._polygon.width=this.width,this._polygon.color=this.color,this._polygon.ground=this.ground,this._polygon.outline.width=this.outlineWidth,this._polygon.outline.color=this.outlineColor,this._polygon.outline.show=this.outlineShow,this._polygon.depthTest=this.depthTest};i(),this.disposers.push(XE.MVVM.watch(()=>({show:this._polygonShow&&this.show,width:this.width,color:[...this.color],ground:this.ground,outlineWidth:this.outlineWidth,outlineColor:this.outlineColor,outlineShow:this.outlineShow,depthTest:this.depthTest}),()=>i()))}get onlyMove(){return this._onlyMove}get fixedPositionsNum(){return this._fixedPositionsNum}flyTo(){this._polygon.flyTo()}}r.defaultOptions={positions:[],show:!0,color:[0,1,0,.1],outlineWidth:2,outlineColor:[0,1,0,1],outlineShow:!0,depthTest:!1};var o=r;const s=XE.Tool;class n extends o{constructor(e,t){super(e,t),this._onlyMove=!0,this._polygonPositions=[],this.disposers.push(XE.MVVM.watch(()=>({minWidthScale:this.minWidthScale,dynamicWidthScale:this.dynamicWidthScale,arrowMaxHeightScale:this.arrowMaxHeightScale,arrowWingWidthScale:this.arrowWingWidthScale}),()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)})),this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(e=>[...e])],()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)}))}change(e,t=.06,i=.1,r=.1,o=2){let n=[...e];const a=n.length;if(a<2||c(n[a-1],n[a-2]))return;console.clear=function(){};let l=n.map(e=>Cesium.Cartesian3.fromRadians(...e,null,new Cesium.Cartesian3));this._polygonPositions.length=0;let h,p,d,u,m,f,y,g=[0,0,0],S=new Array(a).fill(0).map((e,t)=>(h=n[t-1],p=n[t+1],d=n[t],u=h?s.Math.hpr(d,h,g)[0]:0,m=p?s.Math.hpr(d,p,g)[0]:0,f=u&&m?2:1,y=(u+m)/f,y=u>m?y:y-Cesium.Math.PI,y<0?y+Cesium.Math.TWO_PI:y)),w=0,C=[];l.forEach((e,t)=>{h=l[t-1]||e,p=e,w+=Cesium.Cartesian3.distance(h,p),C.push(w)}),C=C.map(e=>w-e);const v=(i/=2)*w,_=(t/=2)*w;let M=new Array(C.length).fill(0).map((e,t)=>_+v*C[t]/w),b=function(e,t,i,r,o,n){let a=e*t,l=.7*a,c=Cesium.Cartesian3.distance(o[0],o[1]);c<l&&(l=c,a=l/.7);let h=s.Math.hpr(n[1],n[0],[0,0,0])[0],p=s.Math.geoMove(n[1],h,l,[0,0,0]),d=s.Math.geoMove(n[1],h,a,[0,0,0]),u=s.Math.hpr(p,n[1],[0,0,0])[0],m=s.Math.hpr(d,n[1],[0,0,0])[0],f=new Array(5);return f[0]=s.Math.geoMove(p,u-Cesium.Math.PI_OVER_TWO,i,[0,0,0]),f[4]=s.Math.geoMove(p,u+Cesium.Math.PI_OVER_TWO,i,[0,0,0]),f[1]=s.Math.geoMove(d,m-Cesium.Math.PI_OVER_TWO,i*r,[0,0,0]),f[3]=s.Math.geoMove(d,m+Cesium.Math.PI_OVER_TWO,i*r,[0,0,0]),f[2]=[...n[1]],f}(w,r,_,o,l.slice(-2),n.slice(-2)),x=[],E=[];n.forEach((e,t)=>{0==t||t==a-1?(x.push(s.Math.geoMove(e,S[t]+Cesium.Math.PI_OVER_TWO,M[t])),E.push(s.Math.geoMove(e,S[t]-Cesium.Math.PI_OVER_TWO,M[t]))):(x.push(s.Math.geoMove(e,S[t]-Cesium.Math.PI,M[t])),E.push(s.Math.geoMove(e,S[t],M[t])))}),x.pop(),E.pop(),x.push(b[0]),E.push(b[b.length-1]);let P=s.Math.interpolatePositions(x,20*a,!1,[]),O=s.Math.interpolatePositions(E,20*a,!1,[]);P.forEach(e=>{this._polygonPositions.push(e[0],e[1])}),b.forEach(e=>{this._polygonPositions.push(e[0],e[1])});for(let e=O.length-1;e>=0;e--)this._polygonPositions.push(O[e][0],O[e][1]);this._polygon.positions=this._polygonPositions,this._polygon.height=0,this._polygonShow=!0}}n.registerType(n,"GeoArrow"),n.defaultOptions={positions:[],show:!0,color:[0,1,0,.1],outlineWidth:2,outlineColor:[0,1,0,1],outlineShow:!0,depthTest:!1,minWidthScale:.06,dynamicWidthScale:.1,arrowMaxHeightScale:.1,arrowWingWidthScale:2};var a=n;let l;function c(e,t){if(!e||!t)return!1;l=0;for(let i=0;i<e.length;i++)if(l=e[i]==t[i]?0:1,l>0)return!1;return!0}let h=new Cesium.Cartesian3;XE.Tool;class p extends XE.Core.XbsjCzmObj{constructor(e,t){super(e,t);let i=e.czm.viewer,r=new Cesium.Cartesian3;Cesium.Cartesian3.fromRadians(...this.position,null,r);let o=Cesium.Transforms.eastNorthUpToFixedFrame(r);this.particleSystem=new Cesium.ParticleSystem({image:"../../XbsjEarth-Plugins/plottingSymbol2/assets/SampleData/smoke.png",startColor:Cesium.Color.LIGHTSEAGREEN.withAlpha(.7),endColor:Cesium.Color.WHITE.withAlpha(0),startScale:this.startScale,endScale:this.endScale,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,minimumSpeed:this.minimumSpeed,maximumSpeed:this.maximumSpeed,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,lifetime:16,modelMatrix:o,emitterModelMatrix:Cesium.Matrix4.IDENTITY,emitter:new Cesium.CircleEmitter(20),updateCallback:()=>{}}),this.disposers.push(XE.MVVM.watch(()=>({startColorRgb:{...this.startColorRgb},endColorRgb:{...this.endColorRgb},startAlpha:{...this.startAlpha},endAlpha:{...this.endAlpha}}),()=>this.updateColor())),this.disposers.push(XE.MVVM.watch(()=>({startColorRgb:{...this.startColorRgb},endColorRgb:{...this.endColorRgb},startAlpha:{...this.startAlpha},endAlpha:{...this.endAlpha}}),()=>this.updateColor())),this.disposers.push(XE.MVVM.watch(()=>({emissionRate:this.emissionRate,maximumSpeed:this.maximumSpeed,minimumSpeed:this.minimumSpeed,lifetime:this.lifetime,minimumImageSize:this.minimumImageSize,maximumImageSize:this.maximumImageSize,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife}),()=>this.update())),this.disposers.push(XE.MVVM.watch(()=>({particleSize:this.particleSize}),()=>this.updateParticleSize())),this.disposers.push(XE.MVVM.watch(()=>[...this.position],()=>this.updateMatrix())),this.disposers.push(XE.MVVM.watch(()=>({gravity:this.gravity}),()=>{this.particleSystem.updateCallback=this.updateGravity(this.gravity)})),i.scene.primitives.add(this.particleSystem)}updateMatrix(){let e=new Cesium.Cartesian3;Cesium.Cartesian3.fromRadians(...this.position,null,e),this.particleSystem.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(e)}updateColor(){this.particleSystem.startColor=Cesium.Color.fromAlpha(this.startColorRgb,this.startAlpha,new Cesium.Color),this.particleSystem.endColor=Cesium.Color.fromAlpha(this.endColorRgb,this.endAlpha,new Cesium.Color)}updateParticleSize(){this.particleSystem.imageSize?(this.particleSystem.imageSize.x=this.particleSize,this.particleSystem.imageSize.y=this.particleSize,this.particleSystem.maximumImageSize.x=this.particleSize,this.particleSystem.maximumImageSize.y=this.particleSize,this.particleSystem.minimumImageSize.x=this.particleSize,this.particleSystem.minimumImageSize.y=this.particleSize):this.particleSystem.imageSize=new Cesium.Cartesian2(this.particleSize,this.particleSize)}update(){this.particleSystem.startColor=this.startColor,this.particleSystem.endColor=this.endColor,this.particleSystem.emitter=this.emitter,this.particleSystem.startScale=this.startScale,this.particleSystem.endScale=this.endScale,this.particleSystem.emissionRate=this.emissionRate,this.particleSystem.minimumSpeed=this.minimumSpeed,this.particleSystem.maximumSpeed=this.maximumSpeed,this.particleSystem.lifetime=this.lifetime,this.particleSystem.image=this.image}updateGravity(e){return(t,i)=>{Cesium.Cartesian3.normalize(t.position,h),Cesium.Cartesian3.multiplyByScalar(h,e*i,h),t.velocity=Cesium.Cartesian3.add(t.velocity,h,t.velocity)}}flyTo(){this.particleSystem&&setTimeout(()=>{let e=this.computeBoundingSphere();viewer.camera.flyToBoundingSphere(e)},500)}computeBoundingSphere(){let e,t={x:-1/0,y:-1/0,z:-1/0},i={x:1/0,y:1/0,z:1/0};this.particleSystem._particles&&this.particleSystem._particles.length&&this.particleSystem._particles.forEach(r=>{e=r.position,console.log(e),t.x=t.x>e.x?t.x:e.x,t.y=t.y>e.y?t.y:e.y,t.z=t.z>e.z?t.z:e.z,i.x=i.x<e.x?i.x:e.x,i.y=i.y<e.y?i.y:e.y,i.z=i.z<e.z?i.z:e.z}),console.log(t,i);let r=Cesium.Cartesian3.midpoint(t,i,new Cesium.Cartesian3),o=Cesium.Cartesian3.distance(t,r);return new Cesium.BoundingSphere(r,o)}}p.defaultOptions={startColorRgb:{red:.12549,green:.69804,blue:.66667},endColorRgb:{red:1,green:1,blue:1},startAlpha:.7,endAlpha:0,position:[1.6988083400554626,.6666896940162155,0],emissionRate:5,gravity:0,minimumParticleLife:12,maximumParticleLife:12,minimumSpeed:1,maximumSpeed:4,startScale:1,endScale:5,particleSize:25,lifetime:20,image:"../../XbsjEarth-Plugins/plottingSymbol2/assets/SampleData/smoke.png",emitter:new Cesium.CircleEmitter(2)},p.registerType(p,"ParticleSystem");var d=p;Cesium.CircleEmitter,Cesium.BoxEmitter,Cesium.Cartesian3,Cesium.SphereEmitter,Cesium.ConeEmitter;XE.Obj.Plots=XE.Obj.Plots||{},XE.Obj.Plots.GeoArrow=a,XE.Obj.Plots.ParticleSystem=d}]);
//# sourceMappingURL=plottingSymbol2.js.map